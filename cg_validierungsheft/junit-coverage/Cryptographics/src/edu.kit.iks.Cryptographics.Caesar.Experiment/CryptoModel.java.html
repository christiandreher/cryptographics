<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>CryptoModel.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">test (Mar 21, 2014 6:54:09 PM)</a> &gt; <a href="../../index.html" class="el_group">Cryptographics</a> &gt; <a href="../index.html" class="el_bundle">src</a> &gt; <a href="index.source.html" class="el_package">edu.kit.iks.Cryptographics.Caesar.Experiment</a> &gt; <span class="el_source">CryptoModel.java</span></div><h1>CryptoModel.java</h1><pre class="source lang-java linenums">package edu.kit.iks.Cryptographics.Caesar.Experiment;

import org.xnap.commons.i18n.I18n;

import edu.kit.iks.CryptographicsLib.Configuration;

/**
 * Model for the visualization of Caesar's cipher.
 * 
 * @author Wasilij Beskorovajnov.
 * 
 */
public class CryptoModel {

	// makes sure only one instance is being generated.
<span class="fc" id="L16">	private static final CryptoModel model = new CryptoModel();</span>

	// ASCII lower case a code.
<span class="fc" id="L19">	public final int ASCII_LC_A = 'a';</span>

	// ASCII upper case A code.
<span class="fc" id="L22">	public final int ASCII_UC_A = 'A';</span>

	// The reach of the key interval.
<span class="fc" id="L25">	private final int MODULO = 26;</span>

<span class="fc" id="L27">	private static I18n i18n = Configuration.getInstance().getI18n(</span>
<span class="fc" id="L28">			CryptoModel.class);</span>

	public static CryptoModel getInstance() {
<span class="fc" id="L31">		return CryptoModel.model;</span>
	}

	/**
	 * Constructor.
	 */
<span class="fc" id="L37">	private CryptoModel() {</span>

<span class="fc" id="L39">	}</span>

	/**
	 * Function for encrypting of all sort of String.&lt;br&gt;
	 * CAREFUL: If you want to encrypt html Strings, make sure all tags are closed!!!!&lt;br&gt;
	 * 
	 * @param key
	 *            the key parameter for encryption.
	 * @param text
	 *            the text to encrypt.
	 * @return the encrypted text.
	 */
	public String enc(int key, String text) {
		// TODO: Check if the String has valid HTML!
<span class="fc" id="L53">		String cipher = &quot;&quot;;</span>
<span class="fc bfc" id="L54" title="All 2 branches covered.">		for (int i = 0; i &lt; text.length(); i++) {</span>
<span class="fc" id="L55">			Character c = text.charAt(i);</span>

<span class="fc bfc" id="L57" title="All 2 branches covered.">			if (Character.isLetter(c)) {</span>

<span class="fc" id="L59">				cipher += String.valueOf(this.shiftChar(key, c));</span>

<span class="fc" id="L61">			} else {</span>
<span class="fc bfc" id="L62" title="All 2 branches covered.">				if (c != '&lt;') {</span>
<span class="fc" id="L63">					cipher += c;</span>
<span class="fc" id="L64">				} else {</span>
<span class="fc" id="L65">					cipher += c;</span>
<span class="fc bfc" id="L66" title="All 2 branches covered.">					while (c != '&gt;') {</span>
<span class="fc" id="L67">						i++;</span>
<span class="fc" id="L68">						c = text.charAt(i);</span>
<span class="fc" id="L69">						cipher += c;</span>
					}
				}
			}

		}
<span class="fc" id="L75">		return cipher;</span>

	}

	/**
	 * Function for decrypting all sort of Strings.
	 * 
	 * @param key
	 *            the key parameter for decryption.
	 * @param cipher
	 *            the cipher to decrypt.
	 * @return decrypted cipher.
	 */
	public String dec(int key, String cipher) {
<span class="fc" id="L89">		return this.enc(-key, cipher);</span>
	}

	/**
	 * Generates a random Integer in the range of 1 and 26.
	 * 
	 * @return the generated key.
	 */
	public int generateKey() {
<span class="fc" id="L98">		return this.generateRandomInt(1, 26);</span>
	}

	/**
	 * Generates a random integer in an interval of a and b.
	 * 
	 * @param a
	 *            the left border of the interval.
	 * @param b
	 *            the right border of the interval.
	 * @return the generated integer.
	 */
	public int generateRandomInt(int a, int b) {
<span class="fc" id="L111">		return (int) (a + ((b - a) * Math.random()));</span>
	}

	/**
	 * Pulls 'randomly' a string from the local pool.
	 * 
	 * @return a random string.
	 */
	public String genRandomBlamings() {
<span class="fc" id="L120">		String[] blamingPool = {</span>
<span class="fc" id="L121">				CryptoModel.i18n.tr(&quot;Oh no. What a pity! It went wrong!&quot;),</span>
<span class="fc" id="L122">				CryptoModel.i18n.tr(&quot;No my friend. This one doesn't work!&quot;),</span>
<span class="fc" id="L123">				CryptoModel.i18n</span>
<span class="fc" id="L124">						.tr(&quot;Sorry, that was wrong. Don't give up now!&quot;) };</span>
<span class="fc" id="L125">		int index = this.generateRandomInt(0, blamingPool.length);</span>
<span class="fc" id="L126">		return blamingPool[index];</span>
	}

	/**
	 * Pulls 'randomly' a plainText from the local pool of genRandomPlainSequence() and encrypts it
	 * with a given key.
	 * 
	 * @param key
	 * @return 'random' cipher.
	 */
	public String genRandomCipher(int key) {
<span class="fc" id="L137">		String plain = this.genRandomPlainSequence();</span>
<span class="fc" id="L138">		return this.enc(key, plain);</span>
	}

	/**
	 * Pulls 'randomly' a string from the local pool.
	 * 
	 * @return 'random' string.
	 */
	public String genRandomGrats() {
<span class="fc" id="L147">		String[] gratulationsPool = {</span>
<span class="fc" id="L148">				CryptoModel.i18n.tr(&quot;Great work, oh mighty Caesar!&quot;),</span>
<span class="fc" id="L149">				CryptoModel.i18n.tr(&quot;Very nice. I like!&quot;),</span>
<span class="fc" id="L150">				CryptoModel.i18n.tr(&quot;No one could've done it better!&quot;) };</span>
<span class="fc" id="L151">		int index = this.generateRandomInt(0, gratulationsPool.length);</span>
<span class="fc" id="L152">		return gratulationsPool[index];</span>
	}

	/**
	 * Pulls 'randomly' string from the local pool.
	 * 
	 * @return 'random' string.
	 */
	public String genRandomPlainSequence() {
<span class="fc" id="L161">		String[] plainTextPool = { CryptoModel.i18n.tr(&quot;ANNA&quot;),</span>
<span class="fc" id="L162">				CryptoModel.i18n.tr(&quot;HANNAH&quot;), CryptoModel.i18n.tr(&quot;BANANA&quot;),</span>
<span class="fc" id="L163">				CryptoModel.i18n.tr(&quot;KOKOS&quot;), CryptoModel.i18n.tr(&quot;SECRET&quot;),</span>
<span class="fc" id="L164">				CryptoModel.i18n.tr(&quot;EPSILON&quot;) };</span>

<span class="fc" id="L166">		int index = this.generateRandomInt(0, plainTextPool.length);</span>
<span class="fc" id="L167">		return plainTextPool[index];</span>
	}

	/**
	 * Pulls 'randomly' a bigger string from the local pool.
	 * 
	 * @return the 'random' text.
	 */
	public String genRandomText() {
<span class="fc" id="L176">		String[] textPool = { CryptoModel.i18n</span>
<span class="fc" id="L177">						.tr(&quot;The diagram you see here shows the frequency of each letter&quot;</span>
								+ &quot; in the text you are reading at the moment. It is called a&quot;
								+ &quot; Histogram. If you would count all E's in this explanation&quot;
								+ &quot; you would get the number you see in the diagram on the column&quot;
								+ &quot; above the letter E. Now the program will encrypt this explanation&quot;
								+ &quot; with an unknown key in a most awesome way and we will see the &quot;
								+ &quot; histogram of the cipher. Click Proceed and see the magic!&quot;) } ;
<span class="fc" id="L184">		return textPool[0];</span>
	}

	/**
	 * Checks if the input is valid.
	 * 
	 * @param input
	 *            the input to check.
	 */
	public boolean isInputValid(String input) {
<span class="fc bfc" id="L194" title="All 4 branches covered.">		return (input.length() &lt; 10 &amp;&amp; input.length() &gt; 0);</span>
	}

	/**
	 * Checks if the key is valid.
	 * 
	 * @param key
	 *            the key to check.
	 * @return
	 */
	public boolean isKeyValid(int key) {
<span class="fc bfc" id="L205" title="All 4 branches covered.">		return (key &gt; 0 &amp;&amp; key &lt;= this.MODULO);</span>
	}

	private char shiftChar(int key, char charToShift) {
<span class="fc" id="L209">		int offset = charToShift - this.ASCII_UC_A;</span>
<span class="fc bfc" id="L210" title="All 2 branches covered.">		if (Character.isLowerCase(charToShift)) {</span>
<span class="fc" id="L211">			offset = charToShift - this.ASCII_LC_A;</span>
<span class="fc" id="L212">			return (char) ((((offset + this.MODULO) + key) % this.MODULO) + this.ASCII_LC_A);</span>
		}
<span class="fc" id="L214">		return (char) ((((offset + this.MODULO) + key) % this.MODULO) + this.ASCII_UC_A);</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.0.201403182114</span>test (Mar 21, 2014 6:54:09 PM)</div></body></html>